<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <!-- CSS de Bootstrap-->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous" />
        <style>
            @import url("https://fonts.googleapis.com/css2?family=Trispace:wght@300;400;600&display=swap");

            :root {
                --bs-body-font-family: "Trispace", sans-serif;
                --bs-body-color: #eef;
                --bs-body-bg: #10121c;
            }
        </style>
        <title>Introducción al Desarrollo Front End con HTML, CSS y JavaScript</title>
    </head>
    <body>
        <header>
            <div class="container">
                <div class="row pt-5">
                    <div class="col-sm-10 col-md-8 col-lg-6 mx-auto">
                        <h1 class="display-4 text-center py-2">Pokédex</h1>
                        <p class="lead">
                          La Pokédex, originalmente solo podía registrar información de los primeros 151 Pokémon que en ese entonces existían (la llamada primera generación de Pokémon: los videojuegos Pokémon Rojo y Azul). Posteriormente, su base de datos se ha ido actualizando hasta ampliar sus opciones de búsqueda y su capacidad para registrar a los 893 Pokémon actuales.
                        </p>
                        <p>
                          La Pokédex, puede registrar información de 2 formas. La primera, cuando el entrenador únicamente ve al pokémon, la Pokédex realiza un escaneo, al detectar al Pokémon, solo almacena su nombre, imagen, gruñido y localización en la región. Mientras que la segunda, cuando un entrenador captura a un Pokémon salvaje, la Pokédex, realiza un análisis intensivo al pokémon logrando mostrar información más detallada como su tipo, peso, estatura y una información breve sobre la criatura.
                        </p>
                    </div>
                </div>
            </div>
        </header>

        <main class="container">
            <div class="accordion mx-md-5 my-5 rounded-0" id="accordionExample">
                <!--Edades de pasajeros-->
                <div class="accordion-item rounded-0">
                    <h2 class="accordion-header bg-dark" id="headingOne">
                        <button class="accordion-button rounded-0" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">Gráfico de categoria</button>
                    </h2>
                    <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
                        <div class="accordion-body text-black-50">
                            <p>Tipos de pokémons.</p>
                            <div class="col-md-6 mx-auto mb-3">
                                <canvas id="primerChart" width="100" height="100"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                <!--Pasajeras y pasajeros-->
                <div class="accordion-item rounded-0">
                    <h2 class="accordion-header" id="headingTwo">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">Gráfico de altura</button>
                    </h2>
                    <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                        <div class="accordion-body text-black-50">
                            <p>Altura de los Pokémons.</p>
                            <div class="col-md-6 mx-auto mb-3">
                                <canvas id="segundoChart" width="100" height="100"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                <!--Clases-->
                <div class="accordion-item rounded-0">
                    <h2 class="accordion-header" id="headingThree">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">Gráfico de peso</button>
                    </h2>
                    <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#accordionExample">
                        <div class="accordion-body text-black-50">
                            <p>Peso de los Pokémons.</p>
                            <div class="col-md-6 mx-auto mb-3">
                                <canvas id="tercerChart" width="100" height="100"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                <!--Sobrevivientes por clases-->
                <div class="accordion-item rounded-0">
                    <h2 class="accordion-header" id="headingFour">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">Gráfico de probabilidad de spawn</button>
                    </h2>
                    <div id="collapseFour" class="accordion-collapse collapse" aria-labelledby="headingFour" data-bs-parent="#accordionExample">
                        <div class="accordion-body text-black-50">
                            <p>Probabilidad de spawn.</p>
                            <canvas id="cuartoChart" width="100" height="60"></canvas>
                        </div>
                    </div>
                </div>
                <!--Mujeres y niños primero-->
                <div class="accordion-item rounded-0">
                    <h2 class="accordion-header" id="headingFive">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFive" aria-expanded="false" aria-controls="collapseFive">Gráfico de promedio de spawn</button>
                    </h2>
                    <div id="collapseFive" class="accordion-collapse collapse" aria-labelledby="headingFive" data-bs-parent="#accordionExample">
                        <div class="accordion-body text-black-50">
                            <p>Promedio spawn</p>
                            <canvas id="quintoChart" width="100" height="30"></canvas>
                        </div>
                    </div>
                </div>
                <!--Fin-->
            </div>
            <div class="row">
                <div class="col-sm-10 col-md-8 col-lg-6 mx-auto">
                    <p>Cada entrenador agrega nueva información a su Pokédex al capturar, recibir o intercambiar nuevos Pokémon que no tenía aún registrados.</p>
                </div>
            </div>
        </main>

        <aside>
            <div class="container">
                <div class="row py-5">
                    <div class="col-sm-10 col-md-8 col-lg-6 mx-auto small text-center">
                        <p>
                            Fuentes: <a href="https://es.wikipedia.org/wiki/Pok%C3%A9dex">Información extraida de Wikipedia.</a>,
                        </p>
                    </div>
                </div>
            </div>
        </aside>

        <footer>
            <div class="container">
                <div class="row">
                    <div class="col"><p class="text-muted mt-5 text-center small">Bootstrap v5.1 y Charts.js</p></div>
                </div>
            </div>
        </footer>

        <!-- Biblioteca de Bootstrap -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
        <!-- Biblioteca Chart.js -->
        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.1/chart.min.js"
            integrity="sha512-QSkVNOCYLtj73J4hbmVoOV6KVZuMluZlioC+trLpewV8qMjsWqlIQvkn1KGX2StWvPMdWGBqim1xlC8krl1EKQ=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
        ></script>
        <!-- Un gran script, que contiene una función asincrónica para ir a buscar un JSON con -->
        <script>
            async function todo() {
              //el fetch
              const consulta = await fetch("https://raw.githubusercontent.com/javicarrascoo/datos/main/datos.json");
              const data = await consulta.json();
              let pokemones = data.pokemon;

              // primer gráfico - tipos
              tipos = {}
              

              // segundo grafico - tamaño
              let menores_1 = 0;
              let mayores_1 = 0;

              // tercer gráfico - peso de los pokemones
              let menores_1k = 0;
              let menores_10k = 0;
              let menores_50k = 0;
              let mayores_50k = 0;

              // cuatro gráfico - chance de spawn
              let menores_1_s = 0;
              let mayores_1_s = 0;

              
              pokemones.forEach((d) => {
                // tipos 
                let tipo = d.type;
                tipo.forEach((t) => {
                  if (tipos[t] == null){
                    tipos[t] = 0;
                  }
                  else{
                    tipos[t] = tipos[t] + 1;
                  }
                });



                // tamaño
                let altura = parseFloat(d.height);
                if(altura < 1){
                  menores_1++;
                }
                else{
                  mayores_1++;;
                }

                // peso 
                let peso = parseFloat(d.weight);
                if (peso < 1){
                  menores_1k++;
                }
                else if(peso < 10){
                  menores_10k++;
                }
                else if(peso < 50){
                  menores_50k++;
                }
                else{
                  mayores_50k++;
                }

                // spawn
                let spawn = d.spawn_chance;
                if(spawn < 1){
                  menores_1_s++;
                }
                else{
                  mayores_1_s++;;
                }

              });

              // tipos
              let large = Object.keys(tipos).length;
              let tipos_colores = []

              for(let i = 0; i < large; i++){
                let r = Math.round(Math.random()*255);
                let b = Math.round(Math.random()*255);
                let g = Math.round(Math.random()*255);
                tipos_colores.push(`rgba(${r}, ${g}, ${b})`);
              }

              new Chart(document.getElementById("primerChart").getContext("2d"), {
                type: "doughnut",
                data: {
                  labels: Object.keys(tipos),
                  datasets: [{ 
                    data: Object.values(tipos), 
                    label: "Tipos", 
                    backgroundColor: tipos_colores 
                  }],
                },
                options: {
                  animation: false,
                  layout: {
                    padding: 10,
                  },
                },
              });


              // altura 
                new Chart(document.getElementById("segundoChart").getContext("2d"), {
                    type: "pie",
                    data: {
                      labels: ["Menores de 1 metro", "Mayores de 1 metro"],
                      datasets: [{ data: [menores_1, mayores_1], label: "altura", backgroundColor: ["#D9B4B2", "#9EBCDA"] }],
                    },
                  options: {
                    animation: false,
                    layout: {
                      padding: 10,
                    }
                  }
                });

              // peso
                new Chart(document.getElementById("tercerChart").getContext("2d"), {
                  type: "bar",
                  data: {
                    labels: ["Menores de 1 Kg", "Entre 1 Kg y 10 Kg", "Entre 10 Kg y 50 Kg", "Mayores a 50 Kg"], 
                    datasets: [{ data: [menores_1k, menores_10k, menores_50k, mayores_50k], label: "Pesos", backgroundColor: ["#8CB1E5"] }],
                    },
                  options: {
                    indexAxis: "y",
                    animation: false,
                    layout: {
                      padding: 40,
                    },
                  }
                });

              // spawn
                new Chart(document.getElementById("cuartoChart").getContext("2d"), {
                    type: "pie",
                    data: {
                      labels: ["Chance de spawn menor a 1", "Chance de spawn mayor a 1"],
                      datasets: [{ data: [menores_1_s, mayores_1_s], label: "altura", backgroundColor: ['rgb(100,0,0)', 'rgb(0,0,100)'] }],
                    },
                  options: {
                    animation: false,
                    layout: {
                      padding: 10,
                    }
                  }
                });


 



           }
            todo().catch((error) => console.error(error));
        </script>
        <!--otro para los extras-->
    </body>
</html>
